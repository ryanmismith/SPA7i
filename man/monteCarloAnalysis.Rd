% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/monteCarloAnalysis.R
\name{monteCarloAnalysis}
\alias{monteCarloAnalysis}
\title{Monte Carlo NPV Simulation with Exit Option for Terminal Year}
\usage{
monteCarloAnalysis(
  Flow,
  Occurrence,
  NominalRate,
  TerminalYear,
  FutureValue,
  Exit = FALSE,
  NumSimulations = 5000,
  Seed = 123,
  SD_Flow = 0.2,
  SD_Discount = 0,
  SD_FutureValue = 0.2
)
}
\arguments{
\item{Flow}{Numeric vector of cash flows for the scenario.}

\item{Occurrence}{Numeric vector of periods for each cash flow. Must be the same length as Flow.}

\item{NominalRate}{Numeric value of the nominal discount rate for the scenario.}

\item{TerminalYear}{Integer representing the terminal year for applying terminal value.}

\item{FutureValue}{Numeric. The future value of standing timber or property at the terminal year.}

\item{Exit}{Logical. If TRUE, the user exits the property at the terminal year (no LEV, just present value of the terminal value).}

\item{NumSimulations}{Integer for the number of simulations to run (default: 1000).}

\item{Seed}{Integer for setting the seed of random number generation for reproducibility (default: 123).}

\item{SD_Flow}{Standard deviation percentage for simulating cash flow variations (default: 0.2 or 20\%).}

\item{SD_Discount}{Standard deviation percentage for simulating discount rate variations (default: 0\%).}

\item{SD_FutureValue}{Standard deviation percentage for simulating future value variations (default: 0.2 or 20\%).}
}
\value{
A list containing all simulated NPVs and confidence intervals (68%, 80%, 90%).
}
\description{
This function performs Monte Carlo simulations to calculate Net Present Value (NPV) under uncertainty.
It uses simpleNPV for regular cash flows, and either landExpectVal (for perpetual holding) or presentValue
(for exit scenarios) at the terminal year value. The function returns the simulated NPVs
and confidence intervals for the results.
}
\examples{
library(ggplot2)

# Exiting the Property (using presentValue)
Flow <- c(100, 200, -150, 300)
Occurrence <- c(1, 2, 3, 4)
NominalRate <- 0.05
TerminalYear <- 40
FutureValue <- 1960

result_exit <- monteCarloAnalysis(Flow, Occurrence, NominalRate,
TerminalYear, FutureValue, Exit = TRUE)

# View results
# result_exit$NPVs           # All simulated NPVs (list length NumSimulations)
result_exit$CI_68          # 68\% confidence interval
result_exit$CI_80          # 80\% confidence interval
result_exit$CI_90          # 90\% confidence interval

# Plot the NPV distribution for exiting the property
ggplot(data.frame(NPV = result_exit$NPVs), aes(x = NPV)) +
  geom_histogram(bins = 30, fill = "blue", alpha = 0.7) +
  labs(title = "NPV Distribution - Exiting the Property", x = "NPV", y = "Frequency") +
  theme_minimal()

# Holding the Property (using landExpectVal)
result_hold <- monteCarloAnalysis(Flow, Occurrence, NominalRate,
TerminalYear, FutureValue, Exit = FALSE)

# View results
# result_exit$NPVs           # All simulated NPVs (list length NumSimulations)
result_hold$CI_68          # 68\% confidence interval
result_hold$CI_80          # 80\% confidence interval
result_hold$CI_90          # 90\% confidence interval

# Plot the NPV distribution for holding the property
ggplot(data.frame(NPV = result_hold$NPVs), aes(x = NPV)) +
  geom_histogram(bins = 30, fill = "green", alpha = 0.7) +
  labs(title = "NPV Distribution - Holding the Property", x = "NPV", y = "Frequency") +
  theme_minimal()

}
\seealso{
\code{\link{ci_table}} \code{\link{landExpectVal}} \code{\link{simpleNPV}}
}
